<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>add place</title>
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.rtl.min.css" integrity="sha384-+qdLaIRZfNu4cVPK/PxJJEy0B0f3Ugv8i482AKY7gwXwhaCroABd086ybrVKTa0q" crossorigin="anonymous">
    <!-- Data Table -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs5/jq-3.6.0/dt-1.12.1/b-2.2.3/r-2.3.0/datatables.min.css"/>
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.dataTables.min.css">
    <!-- Select 2 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <!-- Flat Picker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <!-- Style -->
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

    <!-- start to loader -->
    <div class="loader">
        <img src="assets/imgs/logoWhite.png" alt="">
    </div>

    <div class="sidebar" id="sidebar">
        <div class="close" id="closeSidebar"><i class="fa-solid fa-xmark"></i></div>
        <div class="content">
            <div class="logo">
                <img src="assets/imgs/logo.png" alt="">
            </div>
            <ul class="links">
                <li>
                    <a href="index.html">
                        <span class="icon-co">
                            <img src="assets/imgs/sidebar/home.png" alt="">
                        </span>
                        الرئيسية
                        <i class="fa-solid fa-angle-left icon-right"></i>
                    </a>
                </li>
                <li class="nav-collapse">
                    <a href="#" class="coll-open">
                        <span class="icon-co">
                            <img src="assets/imgs/sidebar/bookings.png" alt="">
                        </span>
                        الحجوزات
                        <i class="fa-solid fa-angle-left icon-right"></i>
                    </a>
                    <ul class="collapse-content">
                        <li>
                            <a href="new-bookings.html" class="coll">
                                <img src="assets/imgs/sidebar/sidebar_box_1.png" alt="">
                                الحجوزات الجديدة
                                <i class="fa-solid fa-angle-left icon-right"></i>
                            </a>
                        </li>
                        <li>
                            <a href="active-booking.html" class="coll">
                                <img src="assets/imgs/sidebar/sidebar_box_2.png" alt="">
                                الحجوزات النشطة
                                <i class="fa-solid fa-angle-left icon-right"></i>
                            </a>
                        </li>
                        <li>
                            <a href="done-bookings.html" class="coll">
                                <img src="assets/imgs/sidebar/sidebar_box_3.png" alt="">
                                الحجوزات المكتملة
                                <i class="fa-solid fa-angle-left icon-right"></i>
                            </a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="services.html">
                        <span class="icon-co">
                            <img src="assets/imgs/sidebar/services.png" alt="">
                        </span>
                        الخدمات
                        <i class="fa-solid fa-angle-left icon-right"></i>
                    </a>
                </li>
                <li>
                    <a href="places.html">
                        <span class="icon-co">
                            <img src="assets/imgs/sidebar/bank.svg" alt="">
                        </span>
                        الأماكن
                        <i class="fa-solid fa-angle-left icon-right"></i>
                    </a>
                </li>
                <li>
                    <a href="conversations.html">
                        <span class="icon-co">
                            <img src="assets/imgs/sidebar/message-text.png" alt="">
                        </span>
                        الرسائل
                        <i class="fa-solid fa-angle-left icon-right"></i>
                    </a>
                </li>
                <li>
                    <a href="profile.html">
                        <span class="icon-co">
                            <img src="assets/imgs/sidebar/user.png" alt="">
                        </span>
                        الملف الشخصي
                        <i class="fa-solid fa-angle-left icon-right"></i>
                    </a>
                </li>
                <li>
                    <a href="wallet.html">
                        <span class="icon-co">
                            <img src="assets/imgs/sidebar/wallet.png" alt="">
                        </span>
                        المحفظة
                        <i class="fa-solid fa-angle-left icon-right"></i>
                    </a>
                </li>
                <li>
                    <a href="login.html" class="log-out-red">
                        <span class="icon-co">
                            <img src="assets/imgs/sidebar/noun_logout.png" alt="">
                        </span>
                        تسجيل الخروج
                        <i class="fa-solid fa-angle-left icon-right"></i>
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <nav class="navbar-me" id="navbar">
        <div class="container">
            <div class="content">
                <div class="menu" id="menu">
                    <img src="assets/imgs/navbar/noun_List_2946302.png" alt="">
                </div>
                <div class="left">
                    <div class="not">
                        <a href="notifications.html"></a>
                        <!-- <img src="assets/imgs/navbar/bell.png" alt=""> -->
                        <i class="fa-regular fa-bell"></i>
                        <span class="number">3</span>
                    </div>
                    <div class="account">
                        <img src="assets/imgs/profile.png" alt="" class="profile-img">
                        <div class="info">
                            <h3 class="account-name">كيوبيد</h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main class="main-sec" id="main">
        <div class="container">

            <!-- Start Main Text -->
            <div class="main-text">
                <h1 class="main-head">اضافة مكان جديد</h1>
                <!-- <p class="head-info">يرجي اختيار المكان أولاً</p> -->
            </div>

            <!-- Start Main Form -->
            <form action="places-detailes.html" id="placeForm">

                <!-- Inputs -->
                <div class="section-style main-section">

                    <div class="form-content section-padding">
                        <div class="row">
                            <div class="col-md-9">
                                <div class="row">
                                    <div class="col-12">
                                        <div class="input-g">
                                            <label for="" class="main-label">
                                               الفئة
                                                <span class="label-hint">*</span>
                                            </label>
                                            <div class="main-input">
                                                <i class="fa-solid fa-angle-down main-icon"></i>
                                                <select name="" id="" class="input-me">
                                                    <option value="" selected disabled>اختر الفئة</option>
                                                    <option value="">تيست</option>
                                                    <option value="">تيست</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="input-g">
                                            <label for="" class="main-label">
                                               المكان الرئيسي
                                                <span class="label-hint">*</span>
                                            </label>
                                            <div class="main-input">
                                                <i class="fa-solid fa-angle-down main-icon"></i>
                                                <select name="" id="" class="input-me">
                                                    <option value="" selected disabled>أضف مكان</option>
                                                    <option value="">تيست</option>
                                                    <option value="">تيست</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="input-g">
                                            <label for="" class="main-label">
                                                الاسم
                                                <span class="label-hint">*</span>
                                            </label>
                                            <div class="main-input">
                                                <input type="text" class="input-me" placeholder="أضف الاسم">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="input-g">
                                            <label for="" class="main-label">
                                                المدينة
                                                <span class="label-hint">*</span>
                                            </label>
                                            <div class="main-input">
                                                <i class="fa-solid fa-angle-down main-icon"></i>
                                                <select name="" id="" class="input-me">
                                                    <option value="" selected disabled>أضف المدينة</option>
                                                    <option value="">المدينة</option>
                                                    <option value="">المدينة</option>
                                                    <option value="">المدينة</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="input-g">
                                            <label for="" class="main-label">
                                                الموقع
                                                <span class="label-hint">*</span>
                                            </label>
                                            <div class="main-input">
                                                <i class="fa-solid fa-location-dot main-icon"></i>
                                                <input type="text" class="input-me" placeholder="أضف موقع المكان" id="inputMap" data-bs-toggle="modal" data-bs-target="#mapModal">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="input-g">
                                            <label for="" class="main-label">
                                                نبذة عن الخدمة
                                                <span class="label-hint">*</span>
                                            </label>
                                            <div class="main-input">
                                                <textarea name="" id="" rows="5" class="input-me" placeholder="نبذة عن الخدمة"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="input-g">
                                            <label for="" class="main-label">
                                                فترات العمل
                                                <span class="label-hint">*</span>
                                            </label>
                                            <div class="main-input">
                                                <!-- <i class="fa-solid fa-angle-down main-icon"></i> -->
                                                <select id="type" class="input-me select-time js-states form-control" multiple="multiple">
                                                    <option value="1" title="morning">صباحى</option>
                                                    <option value="2" title="evening">مسائى</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="input-g">
                                            <label for="" class="main-label">
                                                المبلغ المطلوب للحجز
                                                <span class="label-hint">*</span>
                                            </label>
                                            <div class="main-input">
                                                <input type="number" class="input-me" placeholder="أضف المبلغ">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="input-g">
                                            <label for="" class="main-label">
                                                الشعار
                                                <span class="label-hint">*</span>
                                            </label>
                                            <div class="main-input">
                                                <input type="file" id="img-logo" class="input-file logo-input" />
                                                <label for="img-logo" class="label-file">
                                                    <img src="assets/imgs/gallery.svg" alt="">
                                                </label>
                                                <div class="img-upload-show"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="input-g">
                                            <label for="" class="main-label">
                                                الصور
                                                <span class="label-hint">*</span>
                                            </label>
                                            <div class="main-input">
                                                <input type="file" id="places-imgs" class="input-file places-imgs-input" multiple />
                                                <div class="places-imgs">
                                                    <label for="places-imgs" class="label-file">
                                                        <img src="assets/imgs/gallery.svg" alt="">
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
    
                </div>

                <!-- Dates -->
                <div class="section-style dates-section depended-check">

                    <h4 class="section-header section-padding">الايام الغير متاحه</h4>
                    <div class="days-section section-padding">

                        <div class="day-items"></div>

                        <div class="add-btn up" data-bs-toggle="modal" data-bs-target="#calenderModal">
                            <i class="fa-solid fa-plus" ></i>
                        </div>

                    </div>

                </div>

                <!-- Dates And Prices -->
                <div class="section-style prices-section">

                    <h4 class="section-header section-padding">تحديد الاوقات والاسعار</h4>
                    <div class="prices section-padding">

                        <div class="day-container">
                            <div class="row align-items-end">
    
                                <div class="col-md-3">
                                    <div class="input-g">
                                        <label for="" class="main-label">
                                            تحديد التاريخ
                                        </label>
                                        <div class="main-input">
                                            <i class="fa-regular fa-calendar-days main-icon"></i>
                                            <input type="text" class="input-me day-date" placeholder="حدد التاريخ" >
                                        </div>
                                    </div>
                                </div>
    
                                <div class="col-md-3 morning">
                                    <div class="input-g">
                                        <label for="" class="main-label">
                                            السعر صباحاً
                                        </label>
                                        <div class="main-input">
                                            <input type="text" class="input-me" placeholder="حدد السعر" >
                                        </div>
                                    </div>
                                </div>
    
                                <div class="col-md-3 evening">
                                    <div class="input-g">
                                        <label for="" class="main-label">
                                            السعر مساءاً
                                        </label>
                                        <div class="main-input">
                                            <input type="text" class="input-me" placeholder="حدد السعر" >
                                        </div>
                                    </div>
                                </div>
    
                                <div class="col-md-3">
                                    <div class="input-g">
                                        <div class="add-btn up add-btn-row">
                                            <i class="fa-solid fa-plus"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>
    
                <!-- Start Buttons -->
                <div class="buttons-container">
                    <button type="submit" class="submit-btn up">اضافة</button>
                </div>

            </form>


        </div>
    </main>


    <!-- Modal Map -->
    <div class="modal fade modal-map" id="mapModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="text">من فضلك قم بإدخال العنوان</h1>
                </div>
                <div class="modal-body">
                    <div id="map" style="width:100%;height:400px;"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="my-btn confirm-btn up" data-bs-dismiss="modal">تأكيد</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal calender -->
    <div class="modal fade modal-calender" id="calenderModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="text">قم بإدخال اليوم</h1>
                </div>
                <div class="modal-body">
                    <div class="main-input">
                        <input type="text" hidden placeholder="اختر اليوم" class="calender input-me mb-2" form="placeForm">
                    </div>
                    <!-- <div id="map" style="width:100%;height:400px;"></div> -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="my-btn add-all-date up" data-bs-dismiss="modal">تأكيد</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Jquery -->
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Data Table -->
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs5/jq-3.6.0/dt-1.12.1/b-2.2.3/r-2.3.0/datatables.min.js"></script>
    <!-- Select 2 -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <!-- Flat Picker -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <!-- Map -->
    <script type="text/javascript" src="https://maps.google.com/maps/api/js?key=AIzaSyA9_ve_oT3ynCaAF8Ji4oBuDjOhWEHE92U&libraries=places"></script>

    <!-- Select 2 -->
    <script>
        $(".select-time").select2({
            placeholder: "أضف فترات العمل",
            // allowClear: true
            // dropdownParent: $("#addModalToggle")
        });
    </script>

    <!-- Filter Eve - moning -->
    <script>

        $('.morning').fadeOut();
        $('.evening').fadeOut();

        $('#type').on("select2:select", function(e) {

            console.log(e.params.data);
            if (e.params.data.title === 'mon'){
                $('.morning').fadeIn(700);
                console.log('mon')
            } else if(e.params.data.title === 'eve'){
                $('.evening').fadeIn(700);
                console.log('eve')
            }

        });

        $('#type').on('select2:unselect', function(e){
            if (e.params.data.title === 'mon'){
                $('.morning').fadeOut(400);
                console.log('mon2')
            } else if(e.params.data.title === 'eve'){
                $('.evening').fadeOut(400);
                console.log('eve2')
            }
        })

        // console.log($("#type").select2('destroy').val(''))
    </script>

    <!-- Upload Logo Img -->
    <script>
        let loginInputs = document.querySelectorAll('.logo-input');

        loginInputs.forEach((input) =>{
            let uploadContainer = input.parentElement.querySelector('.img-upload-show');
            let labelFile = input.parentElement.querySelector('.label-file');
            input.onchange = function(){

                let reader = new FileReader();
                reader.onload = ()=>{
                uploadContainer.innerHTML = '';
                uploadContainer.classList.add('active');
                labelFile.style.display = 'none';

                let imageContainer = document.createElement('div');
                imageContainer.classList.add('hidden-img')
                uploadContainer.append(imageContainer);

                // Create Remove Button
                let removeBtn = document.createElement('span');
                removeBtn.classList.add('remove-img');
                removeBtn.innerHTML = `<i class="fa-solid fa-xmark"></i>`;
            
                // Append The Button To Main Div
                imageContainer.append(removeBtn);
            
                // Remove Parent Div From Page When Click The Button
                removeBtn.onclick= function(e){
                    e.target.closest('.hidden-img').remove();
                    labelFile.style.display = 'flex';
                    uploadContainer.classList.remove('active');
                }

                // Create Img
                let img = document.createElement('img');
                img.setAttribute('src', reader.result);
                
                // Append The Img To Main Div
                imageContainer.append(img);
                }
                reader.readAsDataURL(input.files[0]);
            }
        });
    </script>

    <!-- Upload Multiple Images -->
    <script>
        const placesImgs = document.querySelectorAll('.places-imgs-input');
        
        placesImgs.forEach((fileInput) =>{

            fileInput.onchange = function (){
                const imagesDiv = fileInput.parentElement.querySelector('.places-imgs');

                for(file of fileInput.files){
                    // Create Main Div
                    let imgContainer = document.createElement('div');
                    imgContainer.classList.add('hidden-img');
                
                    // Create Input Hidden To Get The File Name
                    let inputHidden = document.createElement('input');
                    inputHidden.setAttribute("type", "hidden");
                    inputHidden.value = `${file.name}`;
                
                    // Append The Input To Main Div
                    imgContainer.append(inputHidden);
                
                    // Create Remove Button
                    let removeBtn = document.createElement('span');
                    removeBtn.classList.add('remove-img');
                    removeBtn.innerHTML = `<i class="fa-solid fa-xmark"></i>`;
                
                    // Append The Button To Main Div
                    imgContainer.append(removeBtn);
                
                    // Remove Parent Div From Page When Click The Button
                    removeBtn.onclick= function(e){
                        if(e.target.classList.contains('remove-img')){
                        e.target.parentElement.remove();
                        } else{
                        e.target.parentElement.parentElement.remove();
                        }
                    }
                
                    let reader = new FileReader();
                    reader.onload = ()=>{
                        // Create Img
                        let img = document.createElement('img');
                        img.setAttribute('src', reader.result);
                        
                        // Append The Img To Main Div
                        imgContainer.append(img);
                    }
                    imagesDiv.append(imgContainer);
                    reader.readAsDataURL(file);
                }
            }
        });

    </script>

    <!-- Initialize And Add The Map -->
    <script>
        function initMap() {
            var location = { lat: 24.746189966314272, lng: 46.87979429238138 };

            var map = new google.maps.Map(document.getElementById("map"), {
                zoom: 4,
                center: location,
            });

            var marker = new google.maps.Marker({
                position: location,
                map: map,
                draggable: true,
                title: "اسحب العلامة"
            });

            let infowindow = [];
            google.maps.event.addListener(marker, 'dragend', function (evt) {

                const geocoder = new google.maps.Geocoder();

                function geoLatLng(){
                    geocoder.geocode({location: evt.latLng}).then((res) =>{
                        let theCountry = res.results[0].formatted_address;

                        let newInfoWindow = new google.maps.InfoWindow({
                            content: `${theCountry}`
                        });

                        infowindow.push(newInfoWindow);
                        for(let i =0; i< infowindow.length; i++){
                            infowindow[i].close();
                            infowindow[infowindow.length - 1].open(map, marker);
                        }

                        let confirmBtn = document.querySelector('.confirm-btn');
                        confirmBtn.addEventListener('click', ()=>{
                            document.getElementById('inputMap').value = `${theCountry}`;
                        });
                    });
                }

                geoLatLng();
            });
        }

        initMap();

    </script>

    <!-- Flat Picker -->
    <script>
        flatpickr(".day-date", {
            disableMobile: "true",
            mode: "multiple",
            dateFormat: "Y-m-d"
        });

        let dateArr = [];

        flatpickr(".calender", {
            disableMobile: "true",
            mode: "multiple",
            inline: true,
            dateFormat: "Y-m-d",
            onChange: function (selectedDates, dateStr, instance) {

                dateArr = dateStr.split(',');

            }
        });

        let daysSection = document.querySelector('.day-items');

        $('.add-all-date').on('click', function(){
            daysSection.innerHTML = ``;
            for(let i =0; i < dateArr.length; i++){

                    let d = new Date(dateArr[i])
                    let mo = new Intl.DateTimeFormat('ar', { month: 'short' }).format(d);
                    let da = new Intl.DateTimeFormat('ar', { day: 'numeric' }).format(d);
                    let dat = new Intl.DateTimeFormat('ar', { weekday: 'short' }).format(d);

                    let dateItem = document.createElement('div');
                    dateItem.innerHTML = `
                        <div class="day-m">${mo}</div>
                        <div class="day-d">${da}</div>
                        <div class="day-t">${dat}</div>
                    `;
    
                    dateItem.classList.add('day-item');
    
                    daysSection.append(dateItem);
            }

            $('.day-item').fadeOut(0);
            $('.day-item').fadeIn(300);
        })

    </script>

    <!-- Add Work Date -->
    <script>
        let plusBtn = document.querySelector('.add-btn-row');
        let workParent = document.querySelector('.prices');

        plusBtn.addEventListener('click', function(){
            let dateRow = document.createElement('div');
            dateRow.innerHTML = `
                <div class="row align-items-end">
                    
                    <div class="col-md-3">
                        <div class="input-g">
                            <label for="" class="main-label">
                                تحديد التاريخ
                            </label>
                            <div class="main-input">
                                <i class="fa-regular fa-calendar-days main-icon"></i>
                                <input type="text" class="input-me day-date" placeholder="حدد التاريخ" >
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3 morning">
                        <div class="input-g">
                            <label for="" class="main-label">
                                السعر صباحاً
                            </label>
                            <div class="main-input">
                                <input type="text" class="input-me" placeholder="حدد السعر" >
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3 evening">
                        <div class="input-g">
                            <label for="" class="main-label">
                                السعر مساءاً
                            </label>
                            <div class="main-input">
                                <input type="text" class="input-me" placeholder="حدد السعر" >
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="input-g">
                            <div class="remove-btn-r up" onclick="deleteDate(this)">
                                <i class="fa-solid fa-xmark"></i>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            dateRow.classList.add('day-container');
            workParent.append(dateRow);

            // Call flatpickr again after adding a new row
            flatpickr(".day-date", {
                disableMobile: "true",
                mode: "multiple",
                dateFormat: "Y-m-d"
            });

            $('.morning').hide();
            $('.evening').hide();

            var bla = $('#type').select2('data')

            for( let i = 0 ; i < bla.length; i++ ){
                $(`.${bla[i].title}`).fadeIn(700);
            }

        });

        function deleteDate(el){
            el.closest('.day-container').remove();
        }
    </script>

    <!-- Filter Eve - moning -->
    <script>

            $('.morning').hide();
            $('.evening').hide();

        $('#type').on("select2:select", function(e) {

            $(`.${e.params.data.title}`).fadeIn(300);

        });

        $('#type').on('select2:unselect', function(e){
            $(`.${e.params.data.title}`).fadeOut(200);
        })

    </script>

    <!-- Main Script -->
    <script src="assets/js/main.js"></script>
</body>
</html>